---
- name: Prepare connection and variables
  hosts: all
  gather_facts: false
  roles:
    - roles/system/connect

- name: Provision the firewall and network controller
  hosts: pfsense
  roles:
    - roles/misc/pfsense
    - roles/misc/unifi

- name: Setup the IDS
  hosts: seconion
  roles:
    - roles/misc/seconion

- name: Reformat network
  hosts: all:!pfsense:!seconion
  roles:
    - role: roles/misc/wipe
      when: false

- name: Setup VM controller and network
  hosts: maas
  roles:
    - roles/misc/maas

- name: Configure systems with common settings and applications
  hosts: all:!pfsense:!seconion
  roles:
    - roles/system/dns
    # - roles/system/hosts
    - roles/system/ssh
    - roles/system/common
    - roles/system/security
    - roles/system/firewall
    - roles/services/sshtarpit
    - roles/system/fuse
    - roles/system/disks
    - roles/tools/starship # Developer note - dotfiles role needs starship installed before it runs
    - roles/system/dotfiles
    - roles/system/vpn
    - roles/system/zsh
    - roles/system/tmux
    - roles/system/motd
    - roles/tools/mas
    - roles/languages/asdf
    - roles/languages/go
    - roles/languages/java
    - roles/languages/sdkman
    - roles/languages/nodejs
    - roles/languages/deno
    - roles/languages/php
    - roles/languages/composer
    - roles/languages/ruby
    - roles/languages/pip
    - roles/languages/rust
    - roles/tools/vault
    - roles/services/antivirus
    - roles/services/cloudflare
    - roles/services/cockpit
    - roles/services/cups
    # - roles/services/dnsmasq
    - roles/services/elasticagent
    - roles/services/goofys
    - roles/services/netdata
    # - roles/services/nginx
    - roles/services/gitlabrunner
    - roles/services/rclone
    - roles/services/restic
    - roles/services/samba
    - roles/services/wazuh
    - roles/virtualization/docker
    - roles/virtualization/kvm
    - roles/virtualization/gitdocker
    - roles/virtualization/gvisor
    - roles/system/warp

- name: Install desktop software
  hosts: desktop
  roles:
    - roles/languages/cocoapods
    - roles/virtualization/dockerpushrm
    - roles/virtualization/dockerslim
    - roles/virtualization/kubernetes
    - roles/virtualization/parallels
    - roles/virtualization/vagrant
    - roles/virtualization/virtualbox
    - roles/virtualization/vmware
    - professormanhattan.androidstudio
    - roles/applications/appium
    - roles/applications/autokey
    - roles/applications/bravebrowser
    - roles/applications/chrome
    - roles/applications/etcher
    - roles/applications/filezilla
    - roles/applications/firefox
    - roles/applications/gimp
    - roles/applications/gitkraken
    - roles/applications/hyper
    - roles/applications/inkscape
    - roles/applications/intellij
    - roles/applications/kitty
    - roles/applications/kodi
    - roles/applications/lollypop
    - roles/applications/mailspring
    - roles/applications/microsoftedge
    - roles/applications/microsofttodo
    - roles/applications/nordvpn
    - roles/applications/office
    - roles/applications/onionshare
    - roles/applications/plex
    - roles/applications/postman
    - roles/applications/qbittorrent
    - roles/applications/raspberryimager
    - roles/applications/rdm
    - roles/applications/remotedesktop
    - roles/applications/sharex
    - roles/applications/shotcut
    - roles/applications/shotwell
    - roles/applications/skype
    - roles/applications/slack
    - roles/applications/tabby
    - roles/applications/teams
    - roles/applications/teamviewer
    - roles/applications/visualstudio
    - roles/applications/vlc
    - roles/applications/vscode
    - roles/applications/wireshark
    - roles/applications/xcode
    - roles/applications/zoom
    - roles/services/zenbot
    - roles/tools/aria
    - roles/tools/autojump
    - roles/tools/awscli
    - roles/tools/awxcli
    - roles/tools/azurecli
    - roles/tools/beets
    - roles/tools/broot
    - roles/tools/bw
    - roles/tools/cointop
    - roles/tools/consultemplate
    - roles/tools/diffsofancy
    - roles/tools/ffmpeg
    - roles/tools/fpm
    - roles/tools/fzf
    - roles/tools/gh
    - roles/tools/gist
    - roles/tools/gitextras
    - roles/tools/gitfuzzy
    - roles/tools/gitlfs
    - roles/tools/gitsecret
    - roles/tools/gitsome
    - roles/tools/gitstats
    - roles/tools/glances
    - roles/tools/googlecloudsdk
    - roles/tools/googler
    - roles/tools/gradle
    - roles/tools/homebrew
    - roles/tools/htop
    - roles/tools/httpie
    - roles/tools/jo
    - roles/tools/jq
    - roles/tools/juju
    - roles/tools/loop
    - roles/tools/lpass
    - roles/tools/lsd
    - roles/tools/mcfly
    - roles/tools/mitmproxy
    - roles/tools/multipass
    - roles/tools/ngrok
    - roles/tools/nmap
    - roles/tools/normit
    - roles/tools/packer
    - roles/tools/pandoc
    - roles/tools/pgcli
    - roles/tools/powershell
    - roles/tools/ripgrep
    - roles/tools/s5cmd
    - roles/tools/scrcpy
    - roles/tools/slackterm
    - roles/tools/teleport
    - roles/tools/tfenv
    - roles/tools/translate
    - roles/tools/tree
    - roles/tools/upx
    - roles/tools/vim
    - roles/tools/watchman
    - roles/tools/wget
    - roles/tools/windowsadmincenter
    - roles/tools/windowspowertoys
    - roles/tools/wpcli
    - roles/tools/yank
    - roles/tools/yarn
    - roles/tools/youtubedl
    - roles/crypto/ledgerlive
    - roles/crypto/monero
    - roles/services/guacamole
    - roles/services/zenbot
    - roles/system/extensions
    - roles/system/desktop
    - roles/tools/zoxide
    - roles/tools/lexicon
    - roles/tools/wails
    - roles/tools/himalaya
    - roles/tools/ghorg
    - roles/tools/sysdig
    - roles/tools/shc
    - roles/tools/recoverpy
    - roles/application/iterm2
    - roles/tools/gitfilterrepo
    - roles/tools/poetry
    - roles/tools/trec
    - roles/tools/quasar

- name: Finish configuring systems
  hosts: all:!pfsense:!seconion
  roles:
    # - roles/misc/easyengine
    # - roles/misc/hosthomepage
    - roles/system/finish
