---
image: docker:git

services:
  - docker:dind

before_script:
  - apk update && apk add --no-cache \
    autoconf \
    automake \
    build-base \
    curl \
    docker \
    gcc \
    git \
    libffi-dev \
    linux-headers \
    musl-dev \
    openssh \
    openssl-dev \
    py3-cryptography \
    py3-pip docker \
    python3-dev
  - docker info
  - python3 --version
  - pip3 install \
    ansible \
    ansiblelint \
    docker \
    molecule \
    yamllint

molecule:
  stage: test
  script:
    - molecule test
