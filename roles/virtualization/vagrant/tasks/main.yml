---
- name: Include variables based on the operating system
  include_vars: "{{ ansible_os_family }}.yml"

- name: Find the latest version of Vagrant VMware Utility from the release page
  uri:
    url: https://releases.hashicorp.com/vagrant-vmware-utility/
    return_content: true
  register: vagrant_vmware_version

- name: Save the version of Vagrant VMware Utility to a variable
  set_fact:
    vagrant_vmware_version: "{{ vagrant_vmware_version.content | regex_search('_(((\\d)*\\.)*\\d*)') | replace ('_','') }}"

- name: Find the latest version of Vagrant from the release page
  uri:
    url: https://releases.hashicorp.com/vagrant/
    return_content: true
  register: vagrant_version

- name: Save the version of Vagrant to a variable
  set_fact:
    vagrant_version: "{{ vagrant_version.content | regex_search('_(((\\d)*\\.)*\\d*)') | replace ('_','') }}"

- name: Include tasks based on the operating system
  become: true
  block:
    - include_tasks: "install-{{ ansible_os_family }}.yml"
